{"id":249,"date":"2014-05-02T18:15:54","date_gmt":"2014-05-02T23:15:54","guid":{"rendered":"http:\/\/justhum.com\/blog\/?p=249"},"modified":"2014-05-04T17:04:30","modified_gmt":"2014-05-04T22:04:30","slug":"printing-support","status":"publish","type":"post","link":"https:\/\/justhum.com\/blog\/printing-support\/","title":{"rendered":"Printing Support"},"content":{"rendered":"<p>We&#8217;ve just recently added printing support to Hum. If you tap the share button you&#8217;ll see a print button next to the email and messages. To my surprise, it was actually quite easy.<\/p>\n<p>Here is what our print method ended up looking like.<\/p>\n<pre>\r\nUIPrintInteractionController *controller = [UIPrintInteractionController sharedPrintController];\r\n    \r\nUIPrintPageRenderer *renderer = [[UIPrintPageRenderer alloc] init];\r\nrenderer.headerHeight = 40.0f; \/\/Optically add padding to the top of the page.\r\nrenderer.footerHeight = 30.0f; \/\/Add some padding on the footer as well.\r\ncontroller.printPageRenderer = renderer;\r\n    \r\nUISimpleTextPrintFormatter *formatter = [[UISimpleTextPrintFormatter alloc] initWithText:self.song.lyrics];\r\n    \r\ncontroller.printFormatter = formatter;\r\nformatter.font = [UIFont fontWithName:@\"Whitney-Print\" size:14.0f]; \/\/Change the typeface and size of our text.\r\nformatter.contentInsets = UIEdgeInsetsMake(0.0f, 30.0f, 0.0f, 30.0f); \/\/Add some spacing on the left and right.\r\n    \r\n[renderer addPrintFormatter: formatter startingAtPageAtIndex: 0];\r\n    \r\nUIPrintInfo *printInfo = [UIPrintInfo printInfo];\r\nprintInfo.jobName = self.song.nameOrPlaceholder;\r\nprintInfo.outputType = UIPrintInfoOutputGrayscale;\r\ncontroller.printInfo = printInfo;\r\n    \r\ncontroller.showsNumberOfCopies = YES; \/\/Printing lyrics is usually for sharing in a rehearsal setting.\r\n    \r\n[controller presentAnimated:YES completionHandler:NULL];\r\n<\/pre>\n<p>That&#8217;s it.<\/p>\n<p>But, as I&#8217;ve experienced with every simple feature in Cocoa, there&#8217;s always at least one &#8216;gotcha&#8217;. Here&#8217;s what I ran into:<\/p>\n<p>1. Using custom fonts is easy, so long as you aren&#8217;t using an .otf. When using an .otf, it would print fine in the simulator, but as soon as there was any real printer output, iOS would fall back to the nearest typeface that worked. When I swapped an .otf for .ttf of our typeface, it worked just fine in both the simulator and real-life printing. I didn&#8217;t find this distinction in any of my googling.<\/p>\n<p>2. Default page margins are way too close to the edge of the printed page. I thought that setting some contentInsets would handle it just fine, but no. By design, the print formatter doesn&#8217;t allow for a bottom inset. With a top inset it works great on the first page, but subsequent pages it&#8217;s ignored. I had to go with a mixed approach and build a renderer to add empty headers and footers for vertical padding, and insets for left and right spacing.<\/p>\n<p>3. If you want leading \/ line-spacing that isn&#8217;t incredibly tight, you&#8217;ll need a workaround. I chose to open up our typeface and manually adjust its vertical metrics so I could fine-tune how spread apart those lines were. I exported a TTF with a custom name and metrics so I wouldn&#8217;t get them confused in our UI declarations. After some tweaking I found these lyrics to be much more legible than the defaults. I wasn&#8217;t able to find a way to change the leading in code alone.<\/p>\n<div id=\"attachment_254\" style=\"width: 1210px\" class=\"wp-caption aligncenter\"><img aria-describedby=\"caption-attachment-254\" class=\"size-full wp-image-254\" src=\"http:\/\/justhum.com\/blog\/wp-content\/uploads\/2014\/04\/printed.jpg\" alt=\"Standard \/ Customized\" width=\"1200\" srcset=\"https:\/\/justhum.com\/blog\/wp-content\/uploads\/2014\/04\/printed.jpg 1200w, https:\/\/justhum.com\/blog\/wp-content\/uploads\/2014\/04\/printed-300x225.jpg 300w, https:\/\/justhum.com\/blog\/wp-content\/uploads\/2014\/04\/printed-1024x768.jpg 1024w\" sizes=\"(max-width: 1200px) 100vw, 1200px\" \/><p id=\"caption-attachment-254\" class=\"wp-caption-text\">Standard \/ Customized<\/p><\/div>\n","protected":false},"excerpt":{"rendered":"<p>We&#8217;ve just recently added printing support to Hum. If you tap the share button you&#8217;ll see a print button next to the email and messages. To my surprise, it was actually quite easy. Here is what our print method ended up looking like. UIPrintInteractionController *controller = [UIPrintInteractionController sharedPrintController]; UIPrintPageRenderer *renderer = [[UIPrintPageRenderer alloc] init]; renderer.headerHeight [&hellip;]<\/p>\n","protected":false},"author":2,"featured_media":0,"comment_status":"closed","ping_status":"closed","sticky":false,"template":"","format":"standard","meta":[],"categories":[1],"tags":[],"_links":{"self":[{"href":"https:\/\/justhum.com\/blog\/wp-json\/wp\/v2\/posts\/249"}],"collection":[{"href":"https:\/\/justhum.com\/blog\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/justhum.com\/blog\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/justhum.com\/blog\/wp-json\/wp\/v2\/users\/2"}],"replies":[{"embeddable":true,"href":"https:\/\/justhum.com\/blog\/wp-json\/wp\/v2\/comments?post=249"}],"version-history":[{"count":10,"href":"https:\/\/justhum.com\/blog\/wp-json\/wp\/v2\/posts\/249\/revisions"}],"predecessor-version":[{"id":404,"href":"https:\/\/justhum.com\/blog\/wp-json\/wp\/v2\/posts\/249\/revisions\/404"}],"wp:attachment":[{"href":"https:\/\/justhum.com\/blog\/wp-json\/wp\/v2\/media?parent=249"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/justhum.com\/blog\/wp-json\/wp\/v2\/categories?post=249"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/justhum.com\/blog\/wp-json\/wp\/v2\/tags?post=249"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}